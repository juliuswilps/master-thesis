import api_helpers

def adjust_graph(feature_data: dict):
    llm = api_helpers.setup()

    graph_dict = dict(zip(feature_data["x_vals"], feature_data["y_vals"][feature_data["current_iteration"]]))

    #system_msg = helpers.get_system_msg(graph_dict)
    messages = [
        {
            "role": "system",
            "content": api_helpers.get_system_msg(graph_dict)
        },
        {
            "role": "user",
            "content": f"Here is the shape function for the feature {feature_data['feature_name']}"
                       f"{graph_dict}."
        }
    ]

    completion = llm.chat.completions.create(
        model="gpt-4o-mini",
        messages=messages,
    )
    response = completion.choices[0].message.content

    print(response)


data = {
    'x_vals': [0.25, 1.0, 2.0, 3.0, 3.7755275347400925, 4.301055069480185, 5.0255275347400925, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0, 12.0, 13.0, 14.0, 15.0, 15.75],
    'y_vals': [[0.0437886000866321, 0.0950148801030437, 0.11993452670786084, 0.09587951914623816, 0.05198270196535033, -0.0185413782835275, -0.0455523678622698, -0.0988308217763614, -0.11672959293929981, -0.23257763260353448, -0.2796777718819023, -0.3130135433384958, -0.3613624434271742, -0.4322217201709816, -0.4973927641625033, -0.4383435052103781, -0.410719230742905, -0.5252174092979337]],
    'adjusted_y_vals': [],
    'adjusted_visible': False,
    'explanation': 'Graph for Number of Active Credit Cards/Lines',
    'feature_type': 'continuous',
    'feature_name': 'Number of Active Credit Cards/Lines',
    'current_iteration': 0
}

data2 = {'x_vals': [3.25, 5.5, 7.0, 8.5, 10.0, 11.0, 12.0, 13.0, 14.0, 15.0, 16.0, 17.0, 18.0, 19.0, 20.0, 21.0, 22.0, 23.0, 24.0, 25.0, 26.0, 27.0, 28.5, 30.0, 31.0, 32.0, 33.0, 34.0, 35.0, 36.0, 37.0, 38.0, 39.0, 40.0, 41.0, 42.0, 43.0, 44.0, 45.0, 46.0, 47.0, 48.0, 49.0, 50.0, 51.0, 52.0, 53.0, 54.0, 55.0, 56.0, 57.0, 58.0, 59.0, 60.0, 61.0, 62.0, 63.0, 64.0, 65.0, 66.0, 67.0, 68.0, 69.0, 70.0, 71.0, 72.0, 73.0, 74.0, 75.0, 76.0, 77.0, 78.0, 79.0, 80.0, 81.0, 82.0, 83.0, 84.0, 85.0, 86.0, 87.0, 88.0, 89.0, 90.0, 91.0, 92.0, 93.0, 94.0, 95.0, 96.0, 97.0, 98.0, 99.0, 100.0, 101.0, 102.0, 103.0, 104.0, 105.0, 106.0, 107.0, 108.0, 109.0, 110.0, 111.0, 112.0, 113.0, 114.0, 115.0, 116.0, 117.0, 118.0, 119.0, 120.0, 121.0, 122.0, 123.0, 124.0, 125.0, 126.0, 127.0, 128.0, 129.0, 130.0, 131.0, 132.0, 133.0, 134.0, 135.0, 136.0, 137.0, 138.0, 139.0, 140.0, 141.0, 142.0, 143.0, 144.0, 145.0, 146.0, 147.0, 148.0, 149.0, 150.0, 151.0, 152.0, 153.0, 154.0, 155.0, 156.0, 157.0, 158.0, 159.0, 160.0, 161.0, 162.0, 163.0, 164.0, 165.0, 166.0, 167.0, 168.0, 169.0, 170.0, 171.0, 172.0, 173.0, 174.0, 175.0, 176.0, 177.0, 178.0, 179.0, 180.0, 181.0, 182.0, 183.0, 184.0, 185.0, 186.0, 187.0, 188.0, 189.0, 190.0, 191.0, 192.0, 193.0, 194.0, 195.0, 196.0, 197.0, 198.0, 199.0, 199.9422757475083, 200.63455149501658, 201.1922757475083, 202.0, 203.0, 204.0, 205.0, 206.0, 207.0, 208.0, 209.0, 210.0, 211.0, 212.0, 213.0, 214.0, 215.0, 216.0, 217.0, 218.0, 219.0, 220.0, 221.0, 222.0, 223.0, 224.0, 225.0, 226.0, 227.0, 228.0, 229.0, 230.0, 231.0, 232.0, 233.0, 234.0, 235.0, 236.0, 237.0, 238.0, 239.0, 240.0, 241.0, 242.0, 243.0, 244.0, 245.0, 246.0, 247.0, 248.0, 249.0, 250.0, 251.0, 252.0, 253.0, 254.0, 255.0, 256.0, 257.0, 258.0, 259.0, 260.0, 261.0, 262.0, 263.0, 264.0, 265.0, 266.0, 267.0, 268.0, 269.0, 270.0, 271.0, 272.0, 273.0, 274.0, 275.0, 276.0, 277.0, 278.0, 279.0, 280.0, 281.0, 282.0, 283.0, 284.0, 285.0, 286.0, 287.0, 288.0, 289.0, 290.0, 291.0, 292.0, 293.0, 294.0, 295.0, 296.0, 297.0, 298.0, 299.0, 300.0, 301.0, 302.0, 303.0, 304.0, 305.0, 306.0, 307.0, 308.0, 309.0, 310.0, 311.0, 312.0, 313.0, 314.0, 315.0, 316.0, 317.0, 318.0, 319.0, 320.0, 321.0, 322.0, 323.0, 324.0, 325.0, 326.0, 327.0, 328.0, 329.0, 330.0, 331.0, 332.0, 333.0, 334.0, 335.0, 336.0, 337.0, 338.0, 339.0, 340.0, 341.0, 342.0, 343.0, 344.0, 345.0, 346.0, 347.0, 348.0, 349.0, 350.0, 351.0, 352.0, 353.0, 354.0, 355.0, 356.0, 357.0, 358.0, 359.0, 360.0, 361.5, 363.0, 364.0, 365.0, 366.0, 367.0, 368.0, 369.0, 370.0, 371.0, 372.0, 373.0, 374.0, 375.0, 376.0, 377.0, 378.0, 379.0, 380.0, 381.0, 382.0, 383.0, 384.0, 385.0, 386.0, 387.0, 388.0, 389.0, 390.0, 391.0, 392.0, 393.0, 394.0, 395.0, 396.0, 397.0, 398.0, 399.0, 400.0, 401.0, 402.0, 403.0, 404.0, 405.5, 407.0, 408.0, 409.0, 410.0, 411.0, 412.0, 413.0, 414.0, 415.5, 417.5, 419.0, 420.0, 421.0, 422.0, 423.0, 424.0, 425.0, 426.0, 427.0, 428.0, 429.0, 430.0, 431.0, 432.0, 433.0, 434.0, 435.0, 436.0, 437.0, 438.0, 439.0, 440.0, 441.0, 442.0, 443.25, 444.75, 446.0, 447.0, 448.5, 450.0, 451.0, 453.0, 455.0, 456.0, 457.25, 458.75, 460.25, 462.25, 464.0, 466.0, 468.0, 469.0, 470.5, 472.5, 474.0, 475.0, 477.0, 479.0, 481.0, 483.0, 484.0, 487.0, 491.0, 494.0, 495.75], 'y_vals': [[0.05562349431212264, 0.008770766976517944, 0.0077837897495757246, -0.0025628898412924173, 0.44427563898699535, -0.24650268263169436, -0.2542488764992031, -0.2593771619859538, -0.25452920770715504, -0.2559053695120641, -0.2557258858531199, -0.2544965866790538, -0.2574064388253502, -0.2572485423128447, -0.25725479873097423, -0.2556864318626045, -0.25414449439180625, -0.2536353384171102, -0.25198651111566633, -0.2505559483856942, -0.24902568684453333, -0.24627678315211896, -0.2340120530173724, -0.2281936646169724, -0.2163538257554421, -0.2144633640524887, -0.2130619796657247, -0.21146899944633726, -0.20830065785840263, -0.20757821707390273, -0.20742986722906673, -0.20676074639483114, -0.20531106381891676, -0.20355969633642987, -0.20263033728860996, -0.17905847964502422, -0.1777551060384008, -0.1749741102244244, -0.17373254884929915, -0.17202830841388386, -0.1714992495677353, -0.16642247794002737, -0.16575168745110205, -0.1649171345184667, -0.16389113355025683, 0.10240149534425888, -0.2763934181958781, -0.3133295823524808, -0.32909686818589784, -0.7056672062606787, -0.5958378820320379, -0.5936495440049249, -0.5737519385587716, -0.5719252091969463, -0.5704936262116631, -0.5671807004172336, -0.5642793732305778, -0.5517363144847456, -0.44455625127816184, -0.44116032944626044, -0.4311457362772765, -0.4282445477257103, -0.42492093902614314, -0.41894435024712895, -0.41582619886109484, -0.41310583958673674, -0.3353269953908808, -0.3169934067957291, -0.31252725129007847, -0.30975624713141403, -0.30784364094840494, -0.30451651706474514, -0.3005312238562035, -0.29729582300962, -0.2922234506615708, -0.2890200742268636, -0.28584532868156903, -0.2817932132197302, -0.2794107192791836, -0.2722022505036387, -0.26961199514755496, -0.26438166160137916, -0.2596881299334626, -0.2563810538340075, -0.2530436998292453, -0.2500179827164761, -0.24737704199997465, -0.24532967867103941, -0.24252535047433457, -0.2382564413305146, -0.23357918670778008, -0.20929018968512628, -0.21045997725280063, -0.20704359509529752, -0.20269176965640862, -0.19996332972350012, -0.19603861761311073, -0.1926271378316608, -0.19021994893927513, -0.18675302383587958, -0.18375582240851762, -0.1790308725663119, -0.17770136760031893, -0.17464893982490756, -0.1721978241534682, -0.16958221300523418, -0.16665144124294692, -0.16353232295293643, -0.1606861310322603, -0.1570018588489644, -0.15508746329872625, -0.15180246056918292, -0.14823133546134665, -0.1386108554795741, -0.1331986321647803, -0.1311681131515216, -0.12760561004414211, -0.12426051004423329, -0.12194657251657195, -0.11547052771415657, -0.11194741323614908, -0.10804140036052777, -0.10377458777286905, -0.10038905076552751, -0.09744633384129697, -0.09399322570716225, -0.09251110316350374, -0.08872587497928755, -0.054326967878385854, -0.052118755765571546, -0.04898234723654725, -0.04480775104674385, -0.042197667258120145, -0.039600209459839185, -0.035631964651161245, -0.03326969805982832, -0.03146753050055291, -0.028095138280630864, -0.02670348629954667, -0.02409488555058311, -0.02239241563253413, -0.020752194333343865, -0.018745631146150694, -0.01781528093072313, -0.015421297721654096, -0.013195781468477932, -0.00994373410750898, -0.006947825067325148, -0.0054357947815329545, -0.003377647977753812, -0.0019708753178423718, -0.000173972490385442, 0.0014650457696784025, 0.0032424312623980885, 0.005356321639531126, 0.00810489512343172, 0.010673994975911897, 0.01234802905968171, 0.012905012221410106, 0.014178046747847292, 0.015296157356615048, 0.016681370178997037, 0.019392052073923062, 0.024112036200090243, 0.02541163591074468, 0.027262612653216917, 0.02932894227494747, 0.032032193919047686, 0.03388249613360166, 0.03678197794750152, 0.03926153375496564, 0.04007531875428757, 0.04181136792726233, 0.0438121243227196, 0.04467818698665216, 0.045763694243944886, 0.047132787279469936, 0.049072472996314405, 0.050726763582803466, 0.051704357148088194, 0.05238642449236227, 0.053244100420588074, 0.05563380118033369, 0.054965693263486624, 0.04740257807575835, 0.05442344898271552, 0.05546139360705283, 0.05596344524989707, 0.057059750296285294, 0.05965153009090602, 0.06130267788624788, -0.08310535317777398, -0.025506635756238325, 0.0005695653239604958, -0.023035966817993886, -0.021074372880140645, -0.019870045624419196, -0.017810798209235503, -0.016445892102379605, -0.013946011101215508, -0.012452884013367896, -0.01124122312040458, -0.00939094176075961, -0.008139226778094213, -0.007024542616255071, -0.005875341094434837, -0.004491868402378683, 0.01915515435910509, 0.020510493465180912, 0.022248737484485078, 0.02413618764570307, 0.03180320935978175, 0.03883308163313962, 0.04079160819981713, 0.04154585428378527, 0.04234850380524692, 0.044151491875168015, 0.04428121110951343, 0.0454407909063003, 0.0459726264590148, 0.04840967841128777, 0.04992851723303264, 0.05183920146144312, 0.05359131902830572, 0.05410272654716237, 0.05498087384057049, 0.05638120869819998, 0.057495840155955366, 0.0595165970832559, 0.06063860032505151, 0.062443355946509745, 0.06504327665794198, 0.06724642526858945, 0.06902904143833971, 0.06948454159485631, 0.0704917759515868, 0.0716763959870597, 0.07299111104784498, 0.07429056979268034, 0.07521814960985786, 0.07706979765556447, 0.07816230505735998, 0.07922855796488036, 0.08177141429151277, 0.08291341778636988, 0.08381802577777475, 0.08565083890761256, 0.0876661171884081, 0.08920723382583899, 0.09071633093766161, 0.09215594031112798, 0.09355596012834397, 0.09558176478089735, 0.09581267678328555, 0.09743087021364003, 0.09903792560960054, 0.10052452181415737, 0.10208131820779422, 0.10436967930495744, 0.10644792961369638, 0.10854347607211186, 0.10956887244661853, 0.1115737026512208, 0.11414294013368528, 0.11620461769955195, 0.11763714198211973, 0.11907024431199074, 0.12111818683724766, 0.12230440815895409, 0.12309553985306776, 0.12403397882598198, 0.12681277322185794, 0.12858541531989912, 0.12996159795237675, 0.13132894388008456, 0.13310694197513692, 0.13381074879233765, 0.13552311026153546, 0.13748675643620265, 0.1390746795442571, 0.14094336908621966, 0.14156320528242067, 0.14254499066633816, 0.14451654416510656, 0.14528997765284596, 0.14542534382048, 0.14704901010579202, 0.14856492423196924, 0.14931786529049124, 0.15050635081162214, 0.15191602477107033, 0.15242200965444594, 0.15319230471617049, 0.15462292032960062, 0.15627526684011972, 0.15798797574161688, 0.1590029351550715, 0.16073268816834818, 0.16273856312764276, 0.1636961441295351, 0.16438591633856275, 0.16530059496450197, 0.17495069200205624, 0.17577328421963515, 0.17602186380335352, 0.17625115253147056, 0.1633176350815922, 0.16375487855482684, 0.16446779651518464, 0.16513531184252025, 0.16589620402785396, 0.16758953740363663, 0.1866060191019978, 0.18727527483920964, 0.18731719370858113, 0.13471851721378209, 0.135585436836664, 0.13574129918349848, 0.13633792932918082, 0.13750658783161077, 0.15213774144995246, 0.16879651720596248, 0.16954423122270915, 0.17082304668419407, 0.17167107256439945, 0.17301233803069263, 0.17960891565055878, 0.1806015030733364, 0.1813306069662821, 0.18250367872611808, 0.18418858575082142, 0.18511622860126434, 0.186381862854644, 0.18759336800087523, 0.18867913259581418, 0.18993108582626497, 0.19090055784624346, 0.19204364950082292, 0.19494530569396087, 0.19670680485304773, 0.19909350037144938, 0.2004822322020918, 0.20233764422430395, 0.2038500314863472, 0.2039839399009964, 0.20463053588440916, 0.2054708304350951, 0.20645125088474026, 0.207326182720152, 0.20931623824310588, 0.21062791813179224, 0.21184934198466726, 0.2126041404067464, 0.2153459471187039, 0.21629004335397847, 0.21752532828760002, 0.2192138733938318, 0.2207109976677287, 0.22170796551097877, 0.2228711420148542, 0.2247812718192142, 0.22856728093347836, 0.23075654026568543, 0.23141382539191402, 0.2318185359502916, 0.23350218354346386, 0.23416476623721275, 0.2349523963606608, 0.2354540472032925, 0.23588779872918625, 0.23665777937760862, 0.23702520185444023, 0.23799569199762352, 0.23808849932300144, 0.23944557262249785, 0.240682082227339, 0.24171700371042562, 0.24252382726358018, 0.24444620863591798, 0.24683846237136936, 0.24774530688335222, 0.24912535119730478, 0.25151278798682075, 0.2528131417815224, 0.2540962372428181, 0.25664345660212146, 0.2592697482703331, 0.2620543302328771, 0.2641416972499639, 0.26710811778315935, 0.2681567084441955, 0.2697940675709272, 0.27338076747671686, 0.27843437685401573, 0.2797796714719947, 0.28275612071162287, 0.28401701883049507, 0.2873332170668673, 0.2884310256787291, 0.28902112052618584, 0.2896261572919233, 0.29076330628533953, 0.29127663052632957, 0.29456920302207923, 0.29499516173707657, 0.2970916600912668, 0.29820892595490844, 0.29977369457510167, 0.3014039335921647, 0.30232157700706075, 0.3043124067447268, 0.3056188062592013, 0.3063167877644167, 0.3087736194474004, 0.30994268662322194, 0.31287319249549117, 0.3118901579489985, 0.31288847626591504, 0.31402018311670593, 0.3156639235384268, 0.316656189299339, 0.31882331319650786, 0.32107289956267765, 0.32517701526592874, 0.3260313201819955, 0.32779350908548405, 0.32959868453372326, 0.3311261139309733, 0.33195600235726735, 0.33172773959468765, 0.33246266756826925, 0.3317145676827634, 0.3321642477025214, 0.33183681803980936, 0.331817186300411, 0.3036509654762641, 0.3037456873530368, 0.30275057125555666, 0.3205149718939359, 0.32040614559635205, 0.3201822786368771, 0.32003508627169114, 0.3205698090688487, 0.3195171767215505, 0.3191315537797488, 0.31851996698783774, 0.31779401974601196, 0.31678110335641524, 0.31510606184542944, 0.31404175578100535, 0.3114741005110959, 0.31113480022540774, 0.30922105021367885, 0.2929790130417442, 0.3044271691428004, 0.3031671219202348, 0.30208729269870604, 0.2981060506061971, 0.30554844906658507, 0.29081765293455364, 0.2890943389385975, 0.2883983339655936, 0.28720903937588815, 0.2858384907812272]], 'adjusted_y_vals': [], 'adjusted_visible': False, 'explanation': 'Graph for Months Since First Credit Account', 'feature_type': 'continuous', 'feature_name': 'Months Since First Credit Account', 'current_iteration': 0}


adjust_graph(data2)